apiVersion: v1
kind: ConfigMap
metadata:
  name: skillflow-config
  namespace: skillflow
data:
  config.yaml: |
    server:
      port: 8080
      mode: release
      read_timeout: 10
      write_timeout: 10
      domain: skillflow.local

    database:
      host: postgres-service
      port: 5432
      user: skillflow
      password: skillflow
      name: skillflow
      ssl_mode: disable
      max_open_conns: 25
      max_idle_conns: 5
      conn_max_lifetime: 300

    redis:
      host: redis-service
      port: 6379
      password: ""
      db: 0
      pool_size: 10

    auth:
      jwt_expiry: 24h
      refresh_expiry: 168h
      oidc:
        issuer_url: https://keycloak.skillflow.local/realms/skillflow
        client_id: skillflow-api
        redirect_url: https://skillflow.local/auth/callback

    storage:
      type: minio
      endpoint: minio-service:9000
      access_key: minioadmin
      secret_key: minioadmin
      bucket: skillflow
      use_ssl: false
      region: us-east-1

    elasticsearch:
      addresses:
        - http://elasticsearch-service:9200
      index_prefix: skillflow

    websocket:
      read_buffer_size: 1024
      write_buffer_size: 1024
      max_message_size: 512

    monitoring:
      prometheus:
        enabled: true
        path: /metrics

    logging:
      level: info
      format: json
      output: stdout

    cors:
      allowed_origins:
        - https://skillflow.local
        - http://localhost:3000
      allowed_methods:
        - GET
        - POST
        - PUT
        - DELETE
        - PATCH
        - OPTIONS
      allowed_headers:
        - Origin
        - Content-Type
        - Authorization
      expose_headers:
        - Content-Length
      allow_credentials: true
      max_age: 12h
